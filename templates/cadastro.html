{% load static %}
{% load i18n %} 
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>agros - {% trans "Cadastro" %}</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

    <style>
        :root { 
            --primary-blue: #003366; 
            --input-border: #d1d5db;
            --input-focus: #0066cc;
        }

        * { box-sizing: border-box; }

        body { 
            font-family: 'Poppins', sans-serif; 
            margin: 0; padding: 0; 
            display: flex; flex-direction: column; align-items: center; 
            min-height: 100vh; 
            background: #ffffff;
            color: #333; 
            overflow-x: hidden; 
        }

        /* 2. Nome da empresa no TOP */
        .brand-top {
            width: 100%;
            max-width: 500px;
            padding: 20px;
            text-align: left;
        }
        .brand-top h1 {
            margin: 0;
            font-size: 2.2rem;
            font-weight: 800;
            color: #ff0000; 
            letter-spacing: 2px;
        }

        /* 1. Imagem com altura reduzida */
        .header-image-container { 
            width: 100%; 
            max-width: 500px; 
            height: 160px; 
            overflow: hidden;
            position: relative;
        }
        .header-image-container img { 
            width: 100%; height: 100%; 
            object-fit: cover; 
        }

        /* 3. Botões intercalar ABAIXO DA IMAGEM */
        .auth-tabs-top { 
            display: flex; width: 100%; max-width: 500px; 
            background: #fff;
            padding: 15px 10px;
            gap: 10px;
        }
        .tab-btn { 
            flex: 1; padding: 12px; 
            text-align: center; text-decoration: none; 
            font-weight: 700; font-size: 1rem; 
            color: #003366; border-radius: 10px;
            border: 2px solid #003366;
            transition: 0.3s; 
        }
        .tab-btn.active { 
            background: #003366; 
            color: #fff; 
        }

        .register-title {
            width: 100%;
            max-width: 500px;
            padding: 10px 20px;
            text-align: center;
        }
        .register-title h2 {
            margin: 0;
            color: #003366;
            font-weight: 800;
            font-size: 2.2rem;
        }

        /* 4. Formulário tocando nas laterais */
        .register-container { 
            background: #fff; 
            padding: 20px 0px; 
            width: 100%; max-width: 500px; 
        }

        .form-group { margin-bottom: 25px; text-align: left; }
        
        .form-group label { 
            font-size: 0.85rem; font-weight: 700; 
            margin-bottom: 8px; display: block; 
            color: #555; text-transform: uppercase;
        }

        /* 6. Local de dígito bem desenhado */
        .input-wrapper { 
            position: relative; 
            display: flex; align-items: center; 
        }

        .auth-form input { 
            width: 100%; 
            padding: 18px 15px 18px 55px; 
            border: 2px solid var(--input-border); 
            border-radius: 12px; 
            background: #fdfdfd; 
            font-size: 1.1rem; color: #000; 
            outline: none; transition: 0.3s; 
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }

        .auth-form input:focus { 
            border-color: var(--input-focus); 
            background: #fff;
            box-shadow: 0 0 0 4px rgba(0,102,204,0.1);
        }

        /* Indicador Fixo de Angola */
        .country-fix {
            position: absolute;
            left: 15px;
            font-weight: 700;
            color: #000;
            font-size: 1rem;
            z-index: 5;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .input-phone { padding-left: 95px !important; }

        .input-wrapper i.main-icon { 
            position: absolute; left: 18px; 
            font-size: 1.3rem; color: #999; 
        }

        .toggle-password { 
            position: absolute; right: 18px; 
            cursor: pointer; color: #999; font-size: 1.2rem;
        }

        .submit-button { 
            width: 100%; padding: 20px; 
            border: none; border-radius: 12px; 
            background: #003366; 
            color: white; font-size: 1.2rem; font-weight: 700; 
            cursor: pointer; display: flex; justify-content: center; 
            align-items: center; gap: 12px; 
            margin-top: 20px;
        }

        @media (max-width: 500px) { 
            .brand-top, .header-image-container, .auth-tabs-top, .register-title, .register-container { 
                width: 100%; 
            }
        }
    </style>
</head>
<body>

    <div class="brand-top">
        <h1>AGROS</h1>
    </div>

    <div class="header-image-container">
        <img src="{% static 'logo_grande.png' %}" alt="Agros Banner">
    </div>

    <div class="auth-tabs-top">
        <a href="{% url 'login' %}" class="tab-btn">Login</a>
        <a href="#" class="tab-btn active">{% trans "Cadastro" %}</a>
    </div>

    <div class="register-title">
        <h2>Cadastra-se</h2>
    </div>

    <div class="register-container">
        <form method="post" class="auth-form" id="registerForm">
            {% csrf_token %}
            
            <div style="padding: 0 20px;">
                <div class="form-group">
                    <label>{% trans "Telefone Móvel" %}</label>
                    <div class="input-wrapper">
                        <div class="country-fix">
                            <span>AO +244</span>
                        </div>
                        <input type="number" name="phone_number" class="input-phone" 
                               placeholder="Número de 9 digito" required 
                               oninput="javascript: if (this.value.length > 9) this.value = this.value.slice(0, 9);">
                    </div>
                </div>

                <div class="form-group">
                    <label>{% trans "Senha de Segurança" %}</label>
                    <div class="input-wrapper">
                        <i class="fa-solid fa-lock main-icon"></i>
                        <input type="password" name="password" id="password" 
                               placeholder="Mínimo 6 caracteres" 
                               minlength="6" required>
                        <i class="fa-solid fa-eye-slash toggle-password" onclick="togglePass('password', this)"></i>
                    </div>
                </div>

                <div class="form-group">
                    <label>{% trans "Confirmar Senha" %}</label>
                    <div class="input-wrapper">
                        <i class="fa-solid fa-lock main-icon"></i>
                        <input type="password" name="confirm_password" id="confirm_password" 
                               placeholder="Repita sua senha" 
                               minlength="6" required>
                        <i class="fa-solid fa-eye-slash toggle-password" onclick="togglePass('confirm_password', this)"></i>
                    </div>
                </div>

                <div class="form-group">
                    <label>{% trans "Código de Convite" %}</label>
                    <div class="input-wrapper">
                        <i class="fa-solid fa-ticket main-icon"></i>
                        <input type="text" id="invite_code" name="invited_by_code" 
                               placeholder="Opcional" 
                               value="{{ request.GET.invite|default:'' }}">
                    </div>
                </div>
                
                <button type="submit" class="submit-button">
                    <span>CRIAR CONTA AGORA</span>
                </button>
            </div>
        </form>
    </div>

    <script>
        function togglePass(id, el) {
            const input = document.getElementById(id);
            if (input.type === "password") {
                input.type = "text";
                el.classList.replace("fa-eye-slash", "fa-eye");
            } else {
                input.type = "password";
                el.classList.replace("fa-eye", "fa-eye-slash");
            }
        }

        document.getElementById('registerForm').onsubmit = function(e) {
            const phone = document.getElementsByName('phone_number')[0].value;
            const pass = document.getElementById('password').value;
            const confirm = document.getElementById('confirm_password').value;

            if(phone.length !== 9) {
                alert("O número de telefone deve ter 9 dígitos.");
                e.preventDefault();
                return;
            }
            if(pass !== confirm) {
                alert("As senhas não coincidem!");
                e.preventDefault();
                return;
            }
        };
    </script>
</body>
</html>
