{% extends "base.html" %}
{% load static %}

{% block title %}Centro de Produção - agros{% endblock %}

{% block content %}
<div class="production-container">
    
    {# 1. TÍTULO SIMPLIFICADO #}
    <div class="production-header">
        <a href="{% url 'home' %}" class="btn-back">
            <i class="fas fa-chevron-left"></i>
        </a>
        <h1 class="page-title">CENTRO DE PRODUÇÃO</h1>
    </div>

    {# AVISO DE COMPROMISSO #}
    <div class="simple-alert">
        <p>A taxa de adesão garante a sua vaga e o compromisso contratual com a empresa.</p>
    </div>

    {# 2. LISTA DE NÍVEIS EM LINHA #}
    <div class="levels-stack">
        {% for level in levels %}
        <div class="line-card {% if level.id in user_levels %}active-border{% endif %}">
            
            <div class="line-content">
                {# VIP E RECARGA #}
                <div class="col-main">
                    <span class="vip-label">{{ level.name }}</span>
                    <span class="price-val">Recarga: KZ {{ level.deposit_value }}</span>
                </div>

                {# GANHO E CONTRATO #}
                <div class="col-stats">
                    <div class="stat-item">
                        <span class="s-label">Ganho Diário</span>
                        <span class="s-value">KZ {{ level.daily_gain }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="s-label">Contrato</span>
                        <span class="s-value">1 ANO</span>
                    </div>
                </div>

                {# BOTÃO DE AÇÃO #}
                <div class="col-action">
                    {% if level.id in user_levels %}
                        {# Se já estiver ativo, apenas mostra o status sem link quebrado #}
                        <div class="btn-status production-mode">
                            PRODUÇÃO
                        </div>
                    {% else %}
                        <form method="post" action="{% url 'nivel' %}">
                            {% csrf_token %}
                            <input type="hidden" name="level_id" value="{{ level.id }}">
                            <button type="submit" class="btn-status activate-mode">
                                ACTIVAR
                            </button>
                        </form>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<style>
    /* RESET E FUNDO BRANCO/LIMPO */
    body {
        background-color: #ffffff !important;
        font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        margin: 0; padding: 0;
    }

    .production-container {
        padding: 20px 15px;
        max-width: 500px;
        margin: 0 auto;
    }

    /* HEADER */
    .production-header {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        gap: 15px;
    }

    .btn-back {
        color: #334155;
        font-size: 1.2rem;
        text-decoration: none;
    }

    .page-title {
        font-size: 1.1rem;
        font-weight: 800;
        color: #1e293b;
        margin: 0;
    }

    .simple-alert {
        background: #f8fafc;
        padding: 10px 15px;
        border-radius: 10px;
        margin-bottom: 20px;
        border: 1px solid #e2e8f0;
    }

    .simple-alert p {
        margin: 0;
        font-size: 11px;
        color: #64748b;
    }

    /* CARDS EM LINHA */
    .levels-stack {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .line-card {
        background: #ffffff;
        border-radius: 12px;
        padding: 12px;
        border: 1px solid #eee;
    }

    .active-border {
        border-color: #10b981;
        background: #f0fdf4;
    }

    .line-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .col-main { flex: 1.2; display: flex; flex-direction: column; }
    .vip-label { font-size: 14px; font-weight: 800; color: #1e293b; }
    .price-val { font-size: 10px; color: #3b82f6; font-weight: 700; }

    .col-stats {
        flex: 2;
        display: flex;
        gap: 10px;
        padding: 0 10px;
        border-left: 1px solid #eee;
        border-right: 1px solid #eee;
        margin: 0 10px;
    }

    .stat-item { display: flex; flex-direction: column; }
    .s-label { font-size: 8px; color: #94a3b8; text-transform: uppercase; font-weight: 700; }
    .s-value { font-size: 10px; color: #334155; font-weight: 700; }

    .col-action { flex: 1; }

    .btn-status {
        padding: 10px 5px;
        border-radius: 8px;
        font-size: 10px;
        font-weight: 800;
        border: none;
        cursor: pointer;
        width: 100%;
        text-align: center;
        display: block;
    }

    .activate-mode { background: #1e293b; color: #fff; }
    .production-mode { background: #10b981; color: #fff; }

    form { margin: 0; }
</style>
{% endblock %}
